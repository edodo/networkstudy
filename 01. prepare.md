
1. 환경설정  
wireshark.org 다운로드  
설치 : 4.0.13 Windows x64 Installer  

관리자 명령어 실행  
```
C:\WINDOWS\system32>ipconfig/all  


Windows IP 구성
   호스트 이름 . . . . . . . . : DESKTOP-TT4O38N
 (중략 ...)
무선 LAN 어댑터 Wi-Fi:

   연결별 DNS 접미사. . . . :
   설명. . . . . . . . . . . . : Intel(R) Dual Band Wireless-AC 8265
   물리적 주소 . . . . . . . . : 34-E1-2D-C5-7A-E7
   DHCP 사용 . . . . . . . . . : 예
   자동 구성 사용. . . . . . . : 예
   링크-로컬 IPv6 주소 . . . . : fe80::4cf4:61ba:5255:cea5%4(기본 설정)
   IPv4 주소 . . . . . . . . . : 192.168.0.83(기본 설정)
   서브넷 마스크 . . . . . . . : 255.255.255.0
   임대 시작 날짜. . . . . . . : 2024년 2월 17일 토요일 오전 9:00:17
   임대 만료 날짜. . . . . . . : 2024년 2월 17일 토요일 오전 11:00:17
   기본 게이트웨이 . . . . . . : 192.168.0.1
   DHCP 서버 . . . . . . . . . : 192.168.0.1
   DHCPv6 IAID . . . . . . . . : 70574381
   DHCPv6 클라이언트 DUID. . . : 00-01-00-01-27-BA-C0-F0-34-E1-2D-C5-7A-E7
   DNS 서버. . . . . . . . . . : 168.126.63.1
                                 168.126.63.2
   Tcpip를 통한 NetBIOS. . . . : 사용
```
확인할 값  
```
호스트 이름 . . . . . . . . : DESKTOP-TT4O38N
물리적 주소 . . . . . . . . : 34-E1-2D-C5-7A-E7
IPv4 주소 . . . . . . . . . : 192.168.0.83(기본 설정)
기본 게이트웨이 . . . . . . : 192.168.0.1
DNS 서버. . . . . . . . . . : 168.126.63.1
                              168.126.63.2
```
   
2. 네트워크 구성  
![network 구성도](/image/001.%20network%20구성도.png)  


MAC ADDR  
24bit( 6자리) + 24bit( 6자리)  
0 0 0 0 0 0 0 0 0 0 0 0  
| — — — — -| — — — — -|  
    OUI        UAA  
  제조사 코드   제조사에서할당하는 값  
16진수,12자리   
Broadcast Mac Addr (FFFF-FFFF-FFFF) 로 바꾸어 통신  

IP 연결과정  
Broadcast 로 전체에게 IP 맞는지 요청  
맞는 IP만 답변옴, MacAddress가 담겨 있음  
한번 문의한 IP의 MacAddress는 내컴퓨터에 캐싱되어 있음(5분이 지나면 지워짐).  
캐싱되어 있으면 Broadcast로 전체에게 IP 요청하지 않음.  
MacAddress 캐싱 관리 명령어 :  
 확인 : arp -a  
 삭제: arp -d  

DNS 질의도 DNS가 캐싱 됨  
확인 : ipconfig/displaydns  
삭제 : ipconfig/flushdns  

컴퓨터 이름에 대한 것도 캐싱되어 있음  
computer name 캐싱  
확인 : nbtstat -c  
삭제 : nbtstat -R  

3. 테스트  
게이트웨이 테스트  
```
C:\WINDOWS\system32>ping 192.168.0.1

Ping 192.168.0.1 32바이트 데이터 사용:
192.168.0.1의 응답: 바이트=32 시간=2ms TTL=64
192.168.0.1의 응답: 바이트=32 시간=4ms TTL=64
192.168.0.1의 응답: 바이트=32 시간=5ms TTL=64
192.168.0.1의 응답: 바이트=32 시간=3ms TTL=64

192.168.0.1에 대한 Ping 통계:
    패킷: 보냄 = 4, 받음 = 4, 손실 = 0 (0% 손실),
왕복 시간(밀리초):
    최소 = 2ms, 최대 = 5ms, 평균 = 3ms
```
처음에는 broad cast로 IP와 mac address 질의하고 그다음에는 캐시에 남아 있는것으로 ip에 대한 mac address로 발송  
확인 : 
```
C:\WINDOWS\system32>arp -a

인터페이스: 192.168.0.83 --- 0x4
  인터넷 주소           물리적 주소           유형
  192.168.0.1           70-5d-cc-ae-7e-5b     동적
  192.168.0.3           f0-ef-86-05-2a-38     동적
  192.168.0.255         ff-ff-ff-ff-ff-ff     정적
  (생략...)
```
캐시삭제 : 
```
C:\WINDOWS\system32>arp -d

C:\WINDOWS\system32>arp -a

인터페이스: 192.168.0.83 --- 0x4
  인터넷 주소           물리적 주소           유형
  192.168.0.1           70-5d-cc-ae-7e-5b     동적
  224.0.0.2             01-00-5e-00-00-02     정적
  224.0.0.22            01-00-5e-00-00-16     정적

인터페이스: 192.168.66.1 --- 0x7
  인터넷 주소           물리적 주소           유형
  224.0.0.22            01-00-5e-00-00-16     정적

인터페이스: 192.168.142.1 --- 0xf
  인터넷 주소           물리적 주소           유형
  224.0.0.22            01-00-5e-00-00-16     정적
```
ping -> dns질의 -> ip얻어돔 -> macaddress 얻어옴
```
C:\WINDOWS\system32>ipconfig/displaydns

Windows IP 구성

    array511.prod.do.dsp.mp.microsoft.com
    ----------------------------------------
    데이터 이름 . . . . . : array511.prod.do.dsp.mp.microsoft.com
    데이터 유형 . . . . . : 1
    TTL(Time To Live) . : 1320
    데이터 길이 . . . . . : 4
    섹션 . . . . . . . : 응답
    (호스트) 레코드 . . . : 52.184.213.21


    array504.prod.do.dsp.mp.microsoft.com
    ----------------------------------------
    데이터 이름 . . . . . : array504.prod.do.dsp.mp.microsoft.com
    데이터 유형 . . . . . : 1
    TTL(Time To Live) . : 1278
    데이터 길이 . . . . . : 4
    섹션 . . . . . . . : 응답
    (호스트) 레코드 . . . : 52.184.216.174
```
삭제  
```
C:\WINDOWS\system32>ipconfig/flushdns

Windows IP 구성

DNS 확인자 캐시를 플러시했습니다.

C:\WINDOWS\system32>ipconfig/displaydns

Windows IP 구성

    1.0.0.127.in-addr.arpa
    ----------------------------------------
    데이터 이름 . . . . . : 1.0.0.127.in-addr.arpa.
    데이터 유형 . . . . . : 12
    TTL(Time To Live) . : 483057
    데이터 길이 . . . . . : 8
    섹션 . . . . . . . : 응답
    PTR 레코드  . . . . . : kubernetes.docker.internal


    kubernetes.docker.internal
    ----------------------------------------
    유형 AAAA의 레코드가 없습니다.


    kubernetes.docker.internal
    ----------------------------------------
    데이터 이름 . . . . . : kubernetes.docker.internal
    데이터 유형 . . . . . : 1
    TTL(Time To Live) . : 483057
    데이터 길이 . . . . . : 4
    섹션 . . . . . . . : 응답
    (호스트) 레코드 . . . : 127.0.0.1

```
컴퓨터 이름 얻어오기   
사용설정 : net use \\clientcom  

캐시확인 : nbtstat -c  
캐시삭제 : nbtstat -R  
